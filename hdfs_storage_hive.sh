# Create Database and Table in Hive 
CREATE DATABASE IF NOT EXISTS census_db;

USE census_db;

CREATE TABLE IF NOT EXISTS county_population (
    SUMLEV INT,
    REGION INT,
    DIVISION INT,
    STATE INT,
    NAME STRING,
    ESTIMATESBASE2020 BIGINT,
    POPESTIMATE2020 BIGINT,
    POPESTIMATE2021 BIGINT,
    POPESTIMATE2022 BIGINT,
    POPESTIMATE2023 BIGINT,
    POPESTIMATE2024 BIGINT,
    NPOPCHG_2020 INT,
    NPOPCHG_2021 INT,
    NPOPCHG_2022 INT,
    NPOPCHG_2023 INT,
    NPOPCHG_2024 INT,
    BIRTHS2020 INT,
    BIRTHS2021 INT,
    BIRTHS2022 INT,
    BIRTHS2023 INT,
    BIRTHS2024 INT,
    DEATHS2020 INT,
    DEATHS2021 INT,
    DEATHS2022 INT,
    DEATHS2023 INT,
    DEATHS2024 INT,
    NATURALCHG2020 INT,
    NATURALCHG2021 INT,
    NATURALCHG2022 INT,
    NATURALCHG2023 INT,
    NATURALCHG2024 INT,
    INTERNATIONALMIG2020 INT,
    INTERNATIONALMIG2021 INT,
    INTERNATIONALMIG2022 INT,
    INTERNATIONALMIG2023 INT,
    INTERNATIONALMIG2024 INT,
    DOMESTICMIG2020 INT,
    DOMESTICMIG2021 INT,
    DOMESTICMIG2022 INT,
    DOMESTICMIG2023 INT,
    DOMESTICMIG2024 INT,
    NETMIG2020 INT,
    NETMIG2021 INT,
    NETMIG2022 INT,
    NETMIG2023 INT,
    NETMIG2024 INT,
    RESIDUAL2020 INT,
    RESIDUAL2021 INT,
    RESIDUAL2022 INT,
    RESIDUAL2023 INT,
    RESIDUAL2024 INT,
    RBIRTH2021 FLOAT,
    RBIRTH2022 FLOAT,
    RBIRTH2023 FLOAT,
    RBIRTH2024 FLOAT,
    RDEATH2021 FLOAT,
    RDEATH2022 FLOAT,
    RDEATH2023 FLOAT,
    RDEATH2024 FLOAT,
    RNATURALCHG2021 FLOAT,
    RNATURALCHG2022 FLOAT,
    RNATURALCHG2023 FLOAT,
    RNATURALCHG2024 FLOAT,
    RINTERNATIONALMIG2021 FLOAT,
    RINTERNATIONALMIG2022 FLOAT,
    RINTERNATIONALMIG2023 FLOAT,
    RINTERNATIONALMIG2024 FLOAT,
    RDOMESTICMIG2021 FLOAT,
    RDOMESTICMIG2022 FLOAT,
    RDOMESTICMIG2023 FLOAT,
    RDOMESTICMIG2024 FLOAT,
    RNETMIG2021 FLOAT,
    RNETMIG2022 FLOAT,
    RNETMIG2023 FLOAT,
    RNETMIG2024 FLOAT
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE
TBLPROPERTIES ("skip.header.line.count"="1");




# Load the data into the Hive table

USE census_db;

LOAD DATA INPATH '/user/hive/warehouse/census_db/census_real_data.csv' INTO TABLE county_population;


# Check the data loaded Correctly
SELECT COUNT(*) FROM county_population;

